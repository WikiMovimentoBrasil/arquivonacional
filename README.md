
<img src="https://img.shields.io/github/issues/WikiMovimentoBrasil/arquivonacional?style=for-the-badge"/> <img src="https://img.shields.io/github/license/WikiMovimentoBrasil/arquivonacional?style=for-the-badge"/> <img src="https://img.shields.io/github/languages/top/WikiMovimentoBrasil/arquivonacional?style=for-the-badge"/>
# Arquivo Nacional

This is a collection of tools to scrape SIAN's (The National Archives of Brazil) website: https://sian.an.gov.br/. The website contains an assortment of national documents, separated into different dossiers, according to their origin. 


## Running the scripts
### fundo.php
This script generates two files: one listing all pages in SIAN's website, and another with links to pdfs and the home page of each dossier / fund. You must edit the file in two separate points before running it.

First, edit your login credentials:
```bash
//Login
$params2 = [
		"login" 		=> "YOUR_LOGIN",
		"senha" 		=> "YOUR_PASSWORD",
		"caminho" 			=> "",
		"destinatario" 		=> "",
		"fonecontato" 		=> "",
		"assinaturacontato" => ""
	];
```

Then, on line 82, replace ENDEREÇO for the URL of the SIAN dossier you wish to download. 
```
	header("Location: https://ENDEREÇO/fundo.php?colecao=".$_GET["colecao"]."&pag=".$_GET["pag"]."&time=".time());
```

To run the script, use the following command:

```bash
php fundo.php
```


### dossie.php
This script generates local html files with the entire content of the pages in a dossier / fund listed in SIAN's website. You must edit the file in two separate points before running it.

First, edit your login credentials:
```bash
//Login
$params2 = [
		"login" 		=> "YOUR_LOGIN",
		"senha" 		=> "YOUR_PASSWORD",
		"caminho" 			=> "",
		"destinatario" 		=> "",
		"fonecontato" 		=> "",
		"assinaturacontato" => ""
	];
```

Then, on line 66, replace ENDEREÇO for the URL of the SIAN dossie you wish to download. 
```
	header("Location: https://ENDEREÇO/dossie.php?id=".$_GET["id"]."&time=".time());
```

To run the script, use the following command:

```bash
php dossie.php
```



### tabelador.php
This script converts the html files generated by dossie.php into a csv file. The end file contains informations such as the code of the pdf related to that dossie / fund, the pdf's title and the date in which it was created. The end file still requires some minimal manual editing. 

To run the script, place it in the same folder as the dossies you wish to convert, as well as the file Html2Text.php, which can be found here: https://github.com/mtibben/html2text/blob/master/src/Html2Text.php

Then, use the following command:

```bash
php tabelador.php
```


## Contributing
Pull requests are welcome. For major changes, please open an issue first to discuss what you would like to change.

Please make sure to update tests as appropriate.

## License
[GNU General Public License v3.0](https://github.com/WikiMovimentoBrasil/wikimotivos/blob/master/LICENSE)

## Credits
This application was developed by the Wiki Movimento Brasil User Group, supported by the University of São Paulo and the University of São Paulo Support Foundation. [? tem parceria com o SIAN tb?]